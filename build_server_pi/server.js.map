{"version":3,"sources":["../app/server.js"],"names":["console","log","ServerApp","Component","app","port","use","static","handleRender","req","res","params","parse","query","counter","parseInt","preloadedState","store","context","html","url","finalState","getState","send","renderFullPage","JSON","stringify","replace","listen"],"mappings":";;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AASA;;AACA;;;;AAKA;;;;AAGA;;;;;;;;;;;;AAjBAA,QAAQC,GAAR,CAAY,aAAZ;;IAEMC,S;;;;;;;;;;;6BACM;AACR,aAAQ;AAAA;AAAA;AAAA;AAAA,OAAR;AACD;;;;EAHqB,gBAAMC,S;;AAS9B;AACA;AACA;;;AAGA;;;AAIA,IAAMC,MAAM,wBAAZ;AACA,IAAMC,OAAO,IAAb;;AAEAD,IAAIE,GAAJ,CAAQ,SAAR,EAAmB,kBAAQC,MAAR,CAAe,QAAf,CAAnB;;AAEA,SAASC,YAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgC;AAC9B,MAAMC,SAAO,aAAGC,KAAH,CAASH,IAAII,KAAb,CAAb;;AAEA,MAAMC,UAAUC,SAASJ,OAAOG,OAAhB,EAAyB,EAAzB,KAAgC,CAAhD;AACA,MAAIE,iBAAiB,EAAEF,gBAAF,EAArB;;AAEA,MAAMG,QAAQ,2CAAd;AACA,MAAMC,UAAU,EAAhB;AACA,MAAMC,OAAO,4BACX;AAAA;AAAA;AACE,gBAAUV,IAAIW,GADhB;AAEE,eAASF,OAFX;AAGE,kCAAC,SAAD;AAHF,GADW,CAAb;;AAQA,MAAMG,aAAaJ,MAAMK,QAAN,EAAnB;AACAZ,MAAIa,IAAJ,CAASC,eAAeL,IAAf,EAAqBE,UAArB,CAAT;AACD;AACDjB,IAAIE,GAAJ,CAAQE,YAAR;;AAEA,SAASgB,cAAT,CAAwBL,IAAxB,EAA8BH,cAA9B,EAA8C;AAC5C,mKAOuBG,IAPvB,4PAWuCM,KAAKC,SAAL,CAAeV,cAAf,EAA+BW,OAA/B,CAAuC,IAAvC,EAA6C,SAA7C,CAXvC;AAiBD;;AAEDvB,IAAIwB,MAAJ,CAAWvB,IAAX","file":"server.js","sourcesContent":["import path from 'path'\nimport Express from 'express'\nimport React from 'react'\nimport { createStore } from 'redux'\nimport { Provider } from 'react-redux'\nimport counterApp from './reducers'\nimport App from './components/App/App'\n\nimport StaticRouter from 'react-router-dom/StaticRouter'\n\nimport config from 'config'\nconsole.log('+++ config:', config)\n\nclass ServerApp extends React.Component {\n  render () {\n    return (<div>ServerApp</div>)\n  }\n}\n\nimport { renderToString } from 'react-dom/server'\nimport qs from 'qs'\n\n// import './favicon.ico'\n// import 'babel-core/polyfill'\n// import 'normalize.css/normalize.css'\nimport ReactDOM from 'react-dom'\n\n// import './scss/app.scss'\nimport store from './stores'\nimport reducer from './reducers'\n\nconst app = Express()\nconst port = 3001\n\napp.use('/static', Express.static('static'))\n\nfunction handleRender(req, res) {\n  const params=qs.parse(req.query)\n\n  const counter = parseInt(params.counter, 10) || 0\n  let preloadedState = { counter }\n\n  const store = createStore(counterApp)\n  const context = {}\n  const html = renderToString(\n    <StaticRouter\n      location={req.url}\n      context={context} >\n      <ServerApp />\n    </StaticRouter>\n  )\n\n  const finalState = store.getState()\n  res.send(renderFullPage(html, finalState))\n}\napp.use(handleRender)\n\nfunction renderFullPage(html, preloadedState) {\n  return `\n    <!doctype html>\n    <html>\n      <head>\n        <title>Redux Universal Example</title>\n      </head>\n      <body>\n        <div id=\"root\">${html}</div>\n        <script>\n          // WARNING: See the following for security issues around embedding JSON in HTML:\n          // http://redux.js.org/recipes/ServerRendering.html#security-considerations\n          window.__PRELOADED_STATE__ = ${JSON.stringify(preloadedState).replace(/</g, '\\\\u003c')}\n        </script>\n        <script src=\"/static/bundle.js\"></script>\n      </body>\n    </html>\n  `\n}\n\napp.listen(port)\n\n"]}